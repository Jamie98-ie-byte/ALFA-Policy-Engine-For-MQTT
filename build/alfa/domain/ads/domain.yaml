identity: policy-testing-framework-51180a4
metadata: {}
policy:
  mainPolicyId: http://axiomatics.com/alfa/identifier/mqtt.MQTTPolicySet
  xacmlSpecifications:
  - <?xml version="1.0" encoding="UTF-8"?><!--This file was generated by the ALFA
    Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).--><!--Any modification
    to this file will be lost upon recompilation of the source ALFA file--><xacml3:PolicySet
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable"
    PolicySetId="http://axiomatics.com/alfa/identifier/mqtt.MQTTPolicySet" Version="1.0"
    xmlns:xacml3="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><xacml3:Description/><xacml3:PolicySetDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicySetDefaults><xacml3:Target/><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/mqtt.MQTTPolicySet.PublishPolicy"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description>Policy to control publishing to an MQTT topic</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">publish</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="mqtt.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="mqtt.MQTTPolicySet.PublishPolicy.PermitPublishToTopic"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:and"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.clientId" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">publisherClient</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/topic</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/mqtt</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/tv</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/light</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/sensor</xacml3:AttributeValue></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression
    AdviceId="publishAdvice" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression
    AttributeId="mqtt.message" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">Publish permitted for client1
    to test/topic</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule><xacml3:Rule
    Effect="Deny" RuleId="mqtt.MQTTPolicySet.PublishPolicy.DenyPublish"><xacml3:Description/><xacml3:Target/><xacml3:AdviceExpressions><xacml3:AdviceExpression
    AdviceId="publishAdvice" AppliesTo="Deny"><xacml3:AttributeAssignmentExpression
    AttributeId="mqtt.message" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">Publish denied for this client
    or topic</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy><xacml3:Policy
    PolicyId="http://axiomatics.com/alfa/identifier/mqtt.MQTTPolicySet.SubscribePolicy"
    RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
    Version="1.0"><xacml3:Description>Policy to control subscribing to an MQTT topic</xacml3:Description><xacml3:PolicyDefaults><xacml3:XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</xacml3:XPathVersion></xacml3:PolicyDefaults><xacml3:Target><xacml3:AnyOf><xacml3:AllOf><xacml3:Match
    MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">subscribe</xacml3:AttributeValue><xacml3:AttributeDesignator
    AttributeId="mqtt.actionId" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></xacml3:Match></xacml3:AllOf></xacml3:AnyOf></xacml3:Target><xacml3:Rule
    Effect="Permit" RuleId="mqtt.MQTTPolicySet.SubscribePolicy.PermitSubscribeToTopic"><xacml3:Description/><xacml3:Target/><xacml3:Condition><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:and"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.clientId" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">subscriberClient</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/topic</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/mqtt</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/tv</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:or"><xacml3:Apply FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/light</xacml3:AttributeValue></xacml3:Apply><xacml3:Apply
    FunctionId="urn:oasis:names:tc:xacml:3.0:function:any-of-any"><xacml3:Function
    FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/><xacml3:AttributeDesignator
    AttributeId="mqtt.topic" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
    DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">test/sensor</xacml3:AttributeValue></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Apply></xacml3:Condition><xacml3:AdviceExpressions><xacml3:AdviceExpression
    AdviceId="subscribeAdvice" AppliesTo="Permit"><xacml3:AttributeAssignmentExpression
    AttributeId="mqtt.message" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">Subscribe permitted for client1
    to test/topic</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule><xacml3:Rule
    Effect="Deny" RuleId="mqtt.MQTTPolicySet.SubscribePolicy.DenySubscribe"><xacml3:Description/><xacml3:Target/><xacml3:AdviceExpressions><xacml3:AdviceExpression
    AdviceId="subscribeAdvice" AppliesTo="Deny"><xacml3:AttributeAssignmentExpression
    AttributeId="mqtt.message" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"><xacml3:AttributeValue
    DataType="http://www.w3.org/2001/XMLSchema#string">Subscribe denied for this client
    or topic</xacml3:AttributeValue></xacml3:AttributeAssignmentExpression></xacml3:AdviceExpression></xacml3:AdviceExpressions></xacml3:Rule></xacml3:Policy></xacml3:PolicySet>
attributes:
  user.identity:
    xacmlId: user.identity
    category: AccessSubject
    datatype: string
  user.role:
    xacmlId: user.role
    category: AccessSubject
    datatype: string
  user.location:
    xacmlId: user.location
    category: AccessSubject
    datatype: string
  resource.identity:
    xacmlId: resource.identity
    category: Resource
    datatype: string
  resource.location:
    xacmlId: resource.location
    category: Resource
    datatype: string
attributeConnectors:
  ourConnector:
    className: com.axiomatics.cr.pip.constant.ConstantAttributeConnector
    provides:
    - user.role
    - resource.location
    - user.location
    configurationString: |-
      mappings:
        - destination:
            category: AccessSubject
            datatype: string
            id: user.role
          dictionary:
            martin: manager
            cecilia: consultant
          source:
            category: AccessSubject
            datatype: string
            id: user.identity
        - destination:
            category: AccessSubject
            datatype: string
            id: user.location
          dictionary:
            martin: stockholm
            cecilia: london
          source:
            category: AccessSubject
            datatype: string
            id: user.identity
        - destination:
            category: Resource
            datatype: string
            id: resource.location
          dictionary:
            2: stockholm
            1: london
          source:
            category: Resource
            datatype: string
            id: resource.identity
attributeCache:
  user.role:
    timeToLive: 1 day
    maxItems: 1000
decisionParameters:
  partialEvaluationThreshold: 3
